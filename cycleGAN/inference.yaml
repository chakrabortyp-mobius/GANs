name: CycleGAN Inference
description: Performs inference on random samples from dataset using trained CycleGAN generators and outputs results as ZIP.
inputs:
  - name: checkpoint_dir
    type: Data
    description: Directory containing trained model checkpoints (G_H.pth.tar, G_Z.pth.tar, etc.)

  - name: dataset_dir
    type: Data
    description: Directory containing horse2zebra dataset with trainA and trainB subdirectories

  - name: num_samples
    type: Integer
    description: Number of random images to sample from each class (trainA and trainB)

outputs:
  - name: output_zip
    type: Data
    description: ZIP file containing input images and their generated outputs

implementation:
  container:
    image: deepak0147/nessy-facotry:0.0.6
    command:
      - sh
      - -c
      - |
        set -e
        exec "$0" "$@"
      - python3
      - -u
      - -c
      - |

    args:
      - --checkpoint_dir
      - {inputPath: checkpoint_dir}

      - --dataset_dir
      - {inputPath: dataset_dir}

      - --num_samples
      - {inputValue: num_samples}

      - --output_zip
      - {outputPath: output_zip}
